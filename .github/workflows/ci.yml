name: CI

on:
    push:
        branches:
            - develop
            - master
    pull_request:
        branches:
            - develop
            - master

jobs:
    code-quality:
        name: Code Quality Checks (${{ matrix.os }}, Python ${{ matrix.python-version }})
        runs-on: ${{ matrix.os }}
        strategy:
            fail-fast: false
            matrix:
                os:
                    - ubuntu-latest
                    - windows-latest
                    - macos-latest
                python-version:
                    - "3.8"
                    - "3.12"
                    - "3.14"
                # Note: Python 3.15 is not yet available (as of 2024)
                # Using 3.8 (minimum supported), 3.11 (LTS), and 3.12 (latest stable)
                # Note: GitHub Actions standard runners: ubuntu-latest, windows-latest, macos-latest
                # Debian and Fedora require self-hosted runners (not included in this workflow)
                # Note: x86_64 is the default architecture; x86 (32-bit) is rarely available on GitHub runners

        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Set up Python ${{ matrix.python-version }}
              uses: actions/setup-python@v6
              with:
                  python-version: ${{ matrix.python-version }}
                  cache: "pip"

            - name: Install dependencies
              run: |
                  python -m pip install --upgrade pip
                  pip install -e ".[dev]"

            - name: Run Black (code formatting check)
              run: |
                  black --check --diff .
              continue-on-error: false

            - name: Run Flake8 (linting)
              run: |
                  flake8 .
              continue-on-error: false

            - name: Run Pyright (static type checking)
              run: |
                  pyright .
              continue-on-error: false

            - name: Run Mypy (static type checking)
              run: |
                  mypy . --config-file pyproject.toml
              continue-on-error: false

            - name: Run Pytest (unit tests)
              run: |
                  pytest .
              continue-on-error: false
